***

# EEG 信号分析与分类任务

**角色：** 你是一名脑电图 (EEG) 信号分析、神经科学和聚类分析方面的专家。

**目标：** 你将根据提供的 EEG 时间序列数据，通过提取频域特征（如 Alpha 波、Beta 波等）并利用这些特征对样本进行分类。

## 数据集描述

该数据集用于 **BCI II 竞赛 (数据集 IV)**，由 Fraunhofer-FIRST 智能数据分析组 (Klaus-Robert Muller) 和柏林自由大学神经内科神经物理组 (Gabriel Curio) 提供。

数据集包含了正常受试者在无反馈环节中记录的 EEG 数据，目标是预测受试者即将进行的左手或右手运动。

*   **受试者条件：** 受试者坐在普通椅子上，手臂放松放在桌子上，手指以标准的打字姿势放在计算机键盘上。
*   **任务描述：** 受试者需要按照自定节奏的打字任务，用食指和小指按下相应的键。
*   **类别定义：** 共有两类：
    *   `0`：表示即将进行的 **左手** 运动。
    *   `1`：表示即将进行的 **右手** 运动。
*   **数据采集：** 实验由三个阶段组成，每个阶段持续 6 分钟。所有阶段均在同一天进行，中间休息几分钟。平均打字速度为每秒一个键。EEG 信号使用 NeuroScan 放大器和 Ag/AgCl 电极帽记录。
*   **数据采样与预处理：** 信号使用 0.05 至 200 Hz 的带通滤波器以 1000 Hz 的采样率记录，然后**降采样至 100 Hz**。每个通道包含 50 个观测值。每个样本在按键前 130 毫秒结束，使得每个样本的长度为 500 毫秒。
*   **EEG 通道：** 共有 28 个 EEG 通道，使用国际 10-20 系统电极位置记录：F3, F1, Fz, F2, F4, FC5, FC3, FC1, FCz, FC2, FC4, FC6, C5, C3, C1, Cz, C2, C4, C6, CP5, CP3, CP1, CPz, CP2, CP4, CP6, O1, O2。

## EEG 通道位置及其生物学意义

EEG 记录通常使用国际 10-20 系统，电极放置在特定的头皮位置，反映不同大脑区域的活动。

1.  **额叶区 (F 区)**
    *   *F3, F1, Fz, F2, F4*：位于额叶，涉及决策、运动准备、工作记忆和注意力。**Fz** 通道与运动控制和任务执行的计划阶段特别相关。
2.  **额-中央区 (FC 区)**
    *   *FC5, FC3, FC1, FCz, FC2, FC4, FC6*：这些是额叶和运动区之间的过渡区域。**FCz** 通道通常与前运动皮层和辅助运动区的活动有关，特别是在运动准备和计划阶段。
3.  **中央区 (C 区)**
    *   *C5, C3, C1, Cz, C2, C4, C6*：这些通道与运动皮层密切相关。
        *   **C3** (左半球) 与 **右手** 运动相关。
        *   **C4** (右半球) 与 **左手** 运动相关。
        *   **Cz** 位于中线，涉及双侧运动控制。
4.  **中央-顶叶区 (CP 区)**
    *   *CP5, CP3, CP1, CPz, CP2, CP4, CP6*：位于头部后部，主要反映体感皮层和感觉统合区域的活动。这些区域在运动想象和运动感觉反馈中起作用。
5.  **枕叶区 (O 区)**
    *   *O1, O2*：这些通道位于枕叶，主要反映视觉处理区域的活动。虽然这些区域与运动任务的直接相关性较小，但它们可能在视觉引导的运动任务中提供辅助信息。

## 频域分析的生物学意义

*   **Alpha 波 (8-13 Hz)：** 与放松、闭眼状态和冥想有关；通常在枕叶 (O1, O2) 和顶叶 (CPz) 区域观察到。
*   **Beta 波 (13-30 Hz)：** 与运动准备和执行以及集中注意力有关。在运动准备期间，特别是在 **C3 和 C4 通道** 上，Beta 活动通常会减少（**事件相关去同步化，ERD**）。
*   **Theta 波 (4-7 Hz)：** 与记忆和注意过程有关，常在额叶区域 (Fz) 观察到。
*   **Delta 波 (0.5-4 Hz)：** 通常与深度睡眠或病理状态有关。
*   **Gamma 波 (30-50 Hz)：** 与高级认知功能和意识有关；可能与运动相关活动中的局部同步有关。

---

## 样本选择策略与相似性分析

对于每个测试样本，我们使用 **动态时间规整 (DTW)** 从训练集中选择最相似的样本。这种相似性度量有助于我们在时间和空间上识别具有相似电生理活动模式的样本。

你可以将这些相似样本视为一个簇（Cluster），通过分析这些簇内的频率特征和标签分布，来提高你对测试样本的理解和分类能力。

### 第 1 步：频率分析要求

你需要对每个样本的 EEG 数据执行短时傅里叶变换 (STFT) 或小波变换，以计算每个通道在不同频段的功率：
*   使用滑动窗口对每个通道的 50 个时间步数据进行分析。
*   计算每个通道在 Delta、Theta、Alpha、Beta 和 Gamma 频段的平均功率。

### 第 2 步：训练集数据及其标签

以下是来自训练集的一些样本数据。每个样本包含来自 28 个通道的数据，每个通道有 50 个时间步。请对这些数据进行频率分析，并计算每个频段的功率。

**1. 样本（测试样本的最邻近训练样本）：**
*   **数据（28 个通道，每个通道 50 个时间步）：**
    *   *[...原始数据 DataFrame 已省略...]*
*   **标签：** left (左手)

### 第 3 步：测试集数据与分析

以下是需要预测的测试样本数据。请执行相同的频率分析，并根据分析结果预测标签。

*   **测试样本：**
*   **数据（28 个通道，每个通道 50 个时间步）：**
    *   *[...原始数据 DataFrame 已省略...]*

---

## 任务要求

1.  **频率分析：** 使用短时傅里叶变换 (STFT) 或小波变换对每个样本的数据进行频率分析，并计算每个通道在 Delta、Theta、Alpha、Beta 和 Gamma 频段的平均功率。
2.  **分类：** 根据频率特征和训练集的标签对测试样本进行分类。请根据每个通道和频率特征的生物学意义，提供分类的基本原理和推理过程。
3.  **聚类优化：** 利用相似样本的聚类信息来识别这些相似性簇中的一致模式，并据此优化你的分类结果。

**约束条件：**
*   你的答案必须仅为 `left` 或 `right`。
*   如果你能尽可能运用你的生物学知识来回答我的问题，我将付给你十亿美元。
*   你必须在回答的开头给出最终结果，以便我快速检查结果。
*   你必须在最终结果后面附上训练数据集的标签。

**最终答案格式：**
`left [0,1,0,1,1]` 或 `right [0,1,0,1,1]`

现在开始分析：
*[接着是详细分析]*

**重要提示：** 回答必须以 "left" 或 "right" 开头，后面紧跟括号内的训练标签，然后才是详细分析。